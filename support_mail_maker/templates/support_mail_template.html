{% extends "support_mail_base.html" %}

{% block content %}

  {# ── Masthead ──────────────────────────────────────────────── #}
  <div>
    <img
      src="https://dozens.nyc3.cdn.digitaloceanspaces.com/learnosity/image-removebg-preview.png"
      alt="SupportMail header"
      class="header-image"
    />
    <p class="publish-date-label">Date published</p>
    <p class="publish-date-value">{{ publish_date|date:"F j, Y" }}</p>
  </div>

  {# ── Introduction ──────────────────────────────────────────── #}
  <div>
    <p>
      Welcome to the {{ edition_month|date:"F" }} edition of SupportMail.
      For those of you new to this aggregation, SupportMail is an internal
      email assembled by the Support team to highlight noteworthy tickets,
      calls, events, etc., that seem likely to be of interest to a larger
      audience. Inclusions are for information purposes and are not limited
      to unsolved issues.
    </p>

    <p>
      If you think any internal party should be added to this distribution
      list, please send a request and email address to
      <a href="mailto:rich.shupe@learnosity.com">Rich Shupe</a>.
    </p>
  </div>

  {% comment %}Start — Issues section{% endcomment %}
  {% if content.issues %}
  <section id="issues">

    <img
      src="https://dozens.nyc3.cdn.digitaloceanspaces.com/learnosity/header_issues.png"
      alt="Issues section header"
      class="section-header-image"
    />

    <p class="content-section-intro-text">
      Here are some of the notable customer issues that have come across
      our desks recently:
    </p>

    {% regroup content.issues by domain as issues_by_topic %}

    {% for topic in issues_by_topic %}
      <section>
        <h3>{{ topic.grouper }}</h3>

        {% for issue in topic.list %}
          <table class="issue-table" role="presentation">
            <tbody>
              <tr>
                <td>
                  <dl>
                    <dt class="sr-only">Title</dt>
                    <dd class="issue-title">{{ issue.title }}</dd>

                    <dt class="sr-only">Customer</dt>
                    <dd class="issue-customer">{{ issue.customer }}</dd>

                    <dt class="sr-only">Summary</dt>
                    <dd class="issue-summary">{{ issue.summary }}</dd>

                    {% if issue.ticket_url %}
                    <dt class="sr-only">Ticket</dt>
                    <dd class="ticket-link">
                      <a href="{{ issue.ticket_url }}">View ticket</a>
                    </dd>
                    {% endif %}
                  </dl>
                </td>
              </tr>
            </tbody>
          </table>
        {% endfor %}

      </section>
    {% endfor %}

  </section>
  {% endif %}
  {% comment %}End — Issues section{% endcomment %}

  {% comment %}Start — Oops section{% endcomment %}
  {% if content.oops %}
  <section id="oops">

    <img
      src="https://dozens.nyc3.cdn.digitaloceanspaces.com/learnosity/header_oops.png"
      alt="Oops section header"
      class="section-header-image"
    />

    <p class="content-section-intro-text">
      Here are some recent oops moments worth noting:
    </p>

    {% regroup content.oops by domain as oops_by_topic %}

    {% for topic in oops_by_topic %}
      <section>
        <h3>{{ topic.grouper }}</h3>

        {% for oop in topic.list %}
          <table class="oops-table" role="presentation">
            <tbody>
              <tr>
                <td>
                  <dl>
                    <dt class="sr-only">Title</dt>
                    <dd class="oops-title">{{ oop.title }}</dd>

                    <dt class="sr-only">Customer</dt>
                    <dd class="oops-customer">{{ oop.customer }}</dd>

                    <dt class="sr-only">Summary</dt>
                    <dd class="oops-summary">{{ oop.summary }}</dd>

                    {% if oop.ticket_url %}
                    <dt class="sr-only">Ticket</dt>
                    <dd class="ticket-link">
                      <a href="{{ oop.ticket_url }}">View ticket</a>
                    </dd>
                    {% endif %}
                  </dl>
                </td>
              </tr>
            </tbody>
          </table>
        {% endfor %}

      </section>
    {% endfor %}

  </section>
  {% endif %}
  {% comment %}End — Oops section{% endcomment %}

  {% comment %}Start — Wins section{% endcomment %}
  {% if content.wins %}
  <section id="wins">

    <img
      src="https://dozens.nyc3.cdn.digitaloceanspaces.com/learnosity/header_wins.png"
      alt="Wins section header"
      class="section-header-image"
    />

    <p class="content-section-intro-text">
      Here are some recent wins worth celebrating:
    </p>

    {% regroup content.wins by domain as wins_by_topic %}

    {% for topic in wins_by_topic %}
      <section>
        <h3>{{ topic.grouper }}</h3>

        {% for win in topic.list %}
          <table class="wins-table" role="presentation">
            <tbody>
              <tr>
                <td>
                  <dl>
                    <dt class="sr-only">Title</dt>
                    <dd class="wins-title">{{ win.title }}</dd>

                    <dt class="sr-only">Customer</dt>
                    <dd class="wins-customer">{{ win.customer }}</dd>

                    <dt class="sr-only">Summary</dt>
                    <dd class="wins-summary">{{ win.summary }}</dd>

                    {% if win.ticket_url %}
                    <dt class="sr-only">Ticket</dt>
                    <dd class="ticket-link">
                      <a href="{{ win.ticket_url }}">View ticket</a>
                    </dd>
                    {% endif %}
                  </dl>
                </td>
              </tr>
            </tbody>
          </table>
        {% endfor %}

      </section>
    {% endfor %}

  </section>
  {% endif %}
  {% comment %}End — Wins section{% endcomment %}

  {% comment %}Start — News section{% endcomment %}
  {% if content.news %}
  <section id="news">

    <img
      src="https://dozens.nyc3.cdn.digitaloceanspaces.com/learnosity/news_header.png"
      alt="News section header"
      class="section-header-image"
    />

    <p class="content-section-intro-text">
      Here is some recent news worth sharing:
    </p>

    {% regroup content.news by domain as news_by_topic %}

    {% for topic in news_by_topic %}
      <section>
        <h3>{{ topic.grouper }}</h3>

        {% for news_item in topic.list %}
          <table class="news-table" role="presentation">
            <tbody>
              <tr>
                <td>
                  <dl>
                    <dt class="sr-only">Title</dt>
                    <dd class="news-title">{{ news_item.title }}</dd>

                    <dt class="sr-only">Customer</dt>
                    <dd class="news-customer">{{ news_item.customer }}</dd>

                    <dt class="sr-only">Summary</dt>
                    <dd class="news-summary">{{ news_item.summary }}</dd>

                    {% if news_item.ticket_url %}
                    <dt class="sr-only">Ticket</dt>
                    <dd class="ticket-link">
                      <a href="{{ news_item.ticket_url }}">View ticket</a>
                    </dd>
                    {% endif %}
                  </dl>
                </td>
              </tr>
            </tbody>
          </table>
        {% endfor %}

      </section>
    {% endfor %}

  </section>
  {% endif %}
  {% comment %}End — News section{% endcomment %}

{% endblock %}
